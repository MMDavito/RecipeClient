var module=angular.module("recipeApp",["ui.router"]);module.config(function($urlRouterProvider,$stateProvider){$urlRouterProvider.otherwise("/"),$stateProvider.state("home",{url:"/",templateUrl:"templates/home.html",controller:"homeCtrl"}).state("recipe",{url:"/recipe/",templateUrl:"templates/recipe.html",controller:"recipeCtrl"}).state("login",{url:"/login",templateUrl:"templates/login.html",controller:"loginCtrl"})}),module.controller("homeCtrl",function($scope,$rootScope,recipeService,$window,$state){var promise=recipeService.getRecipes();promise.then(function(data){$scope.recipes=data.data,console.log(data)}),$scope.fillRecipe=function(id){$rootScope.id=id,console.log("WindoWWW "+$window.location.href),$state.transitionTo("recipe")}}),module.controller("loginCtrl",function($scope,$rootScope,recipeService){$scope.loggIn=function(){console.log("du komer till login"),recipeService.loggIn($scope.username,$scope.password)}}),module.controller("recipeCtrl",function($scope,$rootScope,recipeService){console.log("recipeCTRL"+$rootScope.id);var promise=recipeService.getRecipeIngs($rootScope.id);promise.then(function(data){console.log(data.data),$scope.recipe=data.data})}),module.service("recipeService",function($q,$http,$rootScope){this.getRecipes=function(){var deffer=$q.defer(),url="http://localhost:8080/RecipeServer.0.1/webresources/recipes";return $http.get(url).then(function(data){deffer.resolve(data)}),deffer.promise},this.loggIn=function(username,password){var url="http://localhost:8080/RecipeServer.0.1/webresources/login",auth="Basic "+window.btoa(username+":"+password);console.log(auth),$http({url:url,method:"POST",headers:{Authorization:auth}}).then(function(data,status){console.log("data "+data),console.log("status "+status),console.log("loggedin"),$rootScope.isLoggedIn=!0,$rootScope.user=username,$rootScope.pass=password})},this.fillRecipe=function(id){return console.log("id of filler "+id),"blehe"},this.getRecipeIngs=function(id){console.log("you should get ings of id "+id);var deffer=$q.defer(),url="http://localhost:8080/RecipeServer.0.1/webresources/recipe/"+id;return console.log(url),$http.get(url).then(function(data){deffer.resolve(data)}),deffer.promise}});